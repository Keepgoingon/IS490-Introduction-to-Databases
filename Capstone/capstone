CREATE TABLE A8_STUDENT_ORG
(Stu_org_ID NUMBER(9) NOT NULL,
Stu_org_Name VARCHAR2(40) NOT NULL,
PRIMARY KEY (Stu_org_ID));

CREATE TABLE A8_STUDENT_ORG_DES
(Stu_org_Name VARCHAR2(40) NOT NULL,
Stu_org_des VARCHAR2(200),
PRIMARY KEY (Stu_org_Name));

CREATE TABLE A8_DEPARTMENT
(D_ID NUMBER(9) NOT NULL,
D_Name VARCHAR2(40) NOT NULL,
D_Phone NUMBER,
State VARCHAR2(20),
City VARCHAR2(20),
Street VARCHAR2(20),
Zip NUMBER,
PRIMARY KEY(D_ID));

ALTER TABLE A8_DEPARTMENT DROP COLUMN D_Phone;

INSERT INTO A8_DEPARTMENT
VALUES('001','Information Science',' ',' ',' ','78909');
INSERT INTO A8_DEPARTMENT
VALUES('002','Business',' ',' ',' ','89898');
INSERT INTO A8_DEPARTMENT
VALUES('003','Statistics',' ',' ',' ','89898');
INSERT INTO A8_DEPARTMENT
VALUES('004','Computer Science',' ',' ',' ','76789');
INSERT INTO A8_DEPARTMENT
VALUES('005','Mechanial Engineering',' ',' ',' ','98765');

CREATE TABLE A8_COURSE
(C_ID NUMBER(9) NOT NULL,
Course_NM VARCHAR2(40) NOT NULL,
Credits NUMBER,
Location VARCHAR2(40),
Year NUMBER(4),
Semester VARCHAR2(20),
PRIMARY KEY(C_ID));

INSERT INTO A8_COURSE
VALUES('001','Data Sicence','4',' ','2017','Fall ');
INSERT INTO A8_COURSE
VALUES('002','Database','4',' ','2017','Spring');
INSERT INTO A8_COURSE
VALUES('003','Data Storytelling','4',' ','2017','Fall');

CREATE TABLE A8_COURSE_DES
(Course_NM VARCHAR2(20) NOT NULL,
Description VARCHAR2(200),
PRIMARY KEY (Course_NM));


CREATE TABLE A8_LECTURE
(L_ID NUMBER(9) NOT NULL,
Location VARCHAR2(40),
L_Date DATE,
Topic VARCHAR2(40),
PRIMARY KEY(L_ID));

ALTER TABLE A8_LECTURE
ADD P_ID NUMBER(9) NOT NULL;
ALTER TABLE A8_LECTURE
ADD CONSTRAINT P_ID
FOREIGN KEY (P_ID) REFERENCES A8_TEACHER(P_ID);

INSERT INTO A8_LECTURE
VALUES ('001', '100 Mechanical Building', TO_DATE('2017-10-1','YYYY-MM-DD'),'Peace','001');
INSERT INTO A8_LECTURE
VALUES ('002', '101 Mechanical Building', TO_DATE('2017-11-1','YYYY-MM-DD'),'Humanity','002');
INSERT INTO A8_LECTURE
VALUES ('003', '103 Mechanical Building', TO_DATE('2017-11-2','YYYY-MM-DD'),'Algorithms','003');

CREATE TABLE A8_PROJECT
(P_ID NUMBER(9) NOT NULL,
createDT DATE,
description VARCHAR2(40),
isInside VARCHAR2(10),
parentProjectID NUMBER(9),
PRIMARY KEY(P_ID),
FOREIGN KEY (parentProjectID) REFERENCES A8_PROJECT (P_ID)
ON DELETE CASCADE);

INSERT INTO A8_PROJECT
VALUES ('001',TO_DATE('2010-10-1','YYYY-MM-DD'),' ','NO','') ;
INSERT INTO A8_PROJECT
VALUES ('002',TO_DATE('2011-10-1','YYYY-MM-DD'),' ','NO','') ;
INSERT INTO A8_PROJECT
VALUES ('003',TO_DATE('2013-10-1','YYYY-MM-DD'),' ','YES','001') ;
INSERT INTO A8_PROJECT
VALUES ('004',TO_DATE('2012-10-1','YYYY-MM-DD'),' ','YES','001') ;

CREATE TABLE A8_PERSON
(P_ID NUMBER(9) NOT NULL,
LastNM VARCHAR2(40),
FirstNM VARCHAR2(20),
Phone NUMBER,
Email VARCHAR2(20),
State VARCHAR2(20),
City VARCHAR2(20),
Street VARCHAR2(20),
Zip NUMBER,
BirthDT DATE,
Genre VARCHAR2(20),
D_ID NUMBER(9),
PRIMARY KEY(P_ID),
FOREIGN KEY (D_ID) REFERENCES A8_DEPARTMENT(D_ID)
ON DELETE CASCADE);

INSERT INTO A8_PERSON
VALUES ('001', 'Alex','Feng','2178987653',' ',' ',' ',' ','78987',TO_DATE('1960-10-1','YYYY-MM-DD'),'M','001');
INSERT INTO A8_PERSON
VALUES ('002', 'Payton','Antonsen','2849098789',' ',' ',' ',' ','78732',TO_DATE('1975-12-1','YYYY-MM-DD'),'F','002');
INSERT INTO A8_PERSON
VALUES ('003', 'Geogri','Ma', '2938495098',' ',' ',' ',' ','67321',TO_DATE('1970-1-1','YYYY-MM-DD'),'M','003');
INSERT INTO A8_PERSON
VALUES ('004', 'Matas','Howse', '2347890345',' ',' ',' ',' ','67221',TO_DATE('1973-1-1','YYYY-MM-DD'),'F','004');
INSERT INTO A8_PERSON
VALUES ('005', 'Sachin','Harper','2378590932',' ',' ',' ',' ','67121',TO_DATE('1990-12-13','YYYY-MM-DD'),'M','001');
INSERT INTO A8_PERSON
VALUES ('006', 'Kwame','James', '2378909432',' ',' ',' ',' ','67221',TO_DATE('1995-1-1','YYYY-MM-DD'),'F','001');
INSERT INTO A8_PERSON
VALUES ('007', 'Holger','Shea', '2384980987',' ',' ',' ',' ','67221',TO_DATE('1997-1-1','YYYY-MM-DD'),'M','002');
INSERT INTO A8_PERSON
VALUES ('008', 'Alex','Wang', '2178927653',' ',' ',' ',' ','67221',TO_DATE('2000-1-1','YYYY-MM-DD'),'F','002');
INSERT INTO A8_PERSON
VALUES ('009', 'Alex','Yang', '2178337653',' ',' ',' ',' ','67221',TO_DATE('2005-1-1','YYYY-MM-DD'),'F','003');
INSERT INTO A8_PERSON
VALUES ('010', 'Alex','Ceng','2178937653',' ',' ',' ',' ','67221',TO_DATE('2001-1-1','YYYY-MM-DD'),'F','003');
INSERT INTO A8_PERSON
VALUES ('011','Alex','Seng','2173987653',' ',' ',' ',' ','67221',TO_DATE('2003-1-1','YYYY-MM-DD'),'M','005');


CREATE TABLE A8_STUDENT
(P_ID NUMBER(9) NOT NULL,
GPA FLOAT,
PRIMARY KEY(P_ID),
FOREIGN KEY (P_ID)REFERENCES A8_PERSON(P_ID)
 ON DELETE CASCADE);

 INSERT INTO A8_STUDENT
 VALUES ('006', '2.7');
 INSERT INTO A8_STUDENT
 VALUES ('007', '3.0');
 INSERT INTO A8_STUDENT
 VALUES ('008', '3.1');
 INSERT INTO A8_STUDENT
 VALUES ('009', '3.2');
 INSERT INTO A8_STUDENT
 VALUES ('010', '3.6');
 INSERT INTO A8_STUDENT
 VALUES ('011', '4.0');

CREATE TABLE A8_ORGANIZE
(Stu_org_ID NUMBER(9) NOT NULL,
L_ID  NUMBER(9),
PRIMARY KEY(Stu_org_ID,L_ID),
FOREIGN KEY (Stu_org_ID) REFERENCES A8_STUDENT_ORG(Stu_org_ID)
ON DELETE CASCADE,
FOREIGN KEY (L_ID) REFERENCES A8_LECTURE(L_ID)
ON DELETE CASCADE);

CREATE TABLE A8_TEACHER
(P_ID NUMBER(9) NOT NULL,
Position VARCHAR2(20),
off_building VARCHAR2(40),
off_roomNB VARCHAR2(40),
PRIMARY KEY (P_ID),
FOREIGN KEY (P_ID)REFERENCES A8_PERSON(P_ID)
ON DELETE CASCADE);

INSERT INTO A8_TEACHER
VALUES ('001','Assistant Professor ',' ',' ');
INSERT INTO A8_TEACHER
VALUES ('002','Assistant Professor ',' ',' ');
INSERT INTO A8_TEACHER
VALUES ('003','Associate Professor ',' ',' ');
INSERT INTO A8_TEACHER
VALUES ('004','Assistant Professor ',' ',' ');
INSERT INTO A8_TEACHER
VALUES ('005','Associate Professor ',' ',' ');

CREATE TABLE A8_PARTICIPATE
(P_ID NUMBER(9) NOT NULL,
Stu_org_ID NUMBER(9) NOT NULL,
PRIMARY KEY(P_ID, Stu_org_ID),
FOREIGN KEY (P_ID)REFERENCES A8_STUDENT(P_ID)
ON DELETE CASCADE,
FOREIGN KEY (Stu_org_ID) REFERENCES A8_STUDENT_ORG(Stu_org_ID)
ON DELETE CASCADE);

CREATE TABLE A8_ATTEND(
  P_ID NUMBER(9) NOT NULL,
L_ID NUMBER(9) NOT NULL,
PRIMARY KEY(P_ID, L_ID),
FOREIGN KEY (P_ID)REFERENCES A8_STUDENT(P_ID)
ON DELETE CASCADE,
FOREIGN KEY (L_ID) REFERENCES A8_LECTURE(L_ID)
ON DELETE CASCADE);

INSERT INTO A8_ATTEND
VALUES ('006','001');
INSERT INTO A8_ATTEND
VALUES ('007','001');
INSERT INTO A8_ATTEND
VALUES ('008','001');
INSERT INTO A8_ATTEND
VALUES ('009','001');
INSERT INTO A8_ATTEND
VALUES ('009','002');
INSERT INTO A8_ATTEND
VALUES ('010','003');
INSERT INTO A8_ATTEND
VALUES ('011','003');
INSERT INTO A8_ATTEND
VALUES ('009','003');
INSERT INTO A8_ATTEND
VALUES ('011','002');



CREATE TABLE A8_INSTRUCT(
  Tech_ID NUMBER(9) NOT NULL,
  Stu_ID NUMBER(9) NOT NULL,
  P_ID NUMBER(9) NOT NULL,
  PRIMARY KEY(Tech_ID, Stu_ID,P_ID),
  FOREIGN KEY (Tech_ID) REFERENCES A8_TEACHER(P_ID)
  ON DELETE CASCADE,
  FOREIGN KEY(Stu_ID) REFERENCES A8_STUDENT(P_ID)
  ON DELETE CASCADE,
  FOREIGN KEY (P_ID) REFERENCES A8_PROJECT(P_ID)
  ON DELETE CASCADE);



  INSERT INTO A8_INSTRUCT
  VALUES ('001','006','001');
  INSERT INTO A8_INSTRUCT
  VALUES ('001','007','001');
  INSERT INTO A8_INSTRUCT
  VALUES ('002','008','002');
  INSERT INTO A8_INSTRUCT
  VALUES ('003','009','002');
  INSERT INTO A8_INSTRUCT
  VALUES ('003','009','003');
  INSERT INTO A8_INSTRUCT
  VALUES ('003','010','003');

  CREATE TABLE A8_TEACH(
    P_ID NUMBER(9) NOT NULL,
    C_ID NUMBER(9) NOT NULL,
    PRIMARY KEY (P_ID, C_ID),
    FOREIGN KEY(P_ID) REFERENCES A8_TEACHER(P_ID)
    ON DELETE CASCADE,
    FOREIGN KEY(C_ID) REFERENCES A8_COURSE(C_ID)
    ON DELETE CASCADE);

CREATE TABLE A8_TAKE(
      P_ID NUMBER(9) NOT NULL,
      C_ID NUMBER(9) NOT NULL,
      Grade FLOAT,
      C_Date DATE,
      PRIMARY KEY (P_ID, C_ID, Grade,C_Date ),
      FOREIGN KEY(P_ID) REFERENCES A8_STUDENT(P_ID)
      ON DELETE CASCADE,
      FOREIGN KEY(C_ID) REFERENCES A8_COURSE(C_ID)
      ON DELETE CASCADE);

INSERT INTO A8_TAKE
VALUES ('006', '001','99.2',TO_DATE('2017-1-13','YYYY-MM-DD'));
INSERT INTO A8_TAKE
VALUES ('007', '001','91.2',TO_DATE('2017-1-13','YYYY-MM-DD'));
INSERT INTO A8_TAKE
VALUES ('008', '001','92.2',TO_DATE('2017-1-13','YYYY-MM-DD'));
INSERT INTO A8_TAKE
VALUES ('009', '001','93.2',TO_DATE('2017-8-23','YYYY-MM-DD'));
INSERT INTO A8_TAKE
VALUES ('006', '002','98.2',TO_DATE('2017-8-23','YYYY-MM-DD'));
INSERT INTO A8_TAKE
VALUES ('007', '002','60.2',TO_DATE('2017-1-13','YYYY-MM-DD'));
INSERT INTO A8_TAKE
VALUES ('008', '003','70.9',TO_DATE('2017-1-13','YYYY-MM-DD'));
INSERT INTO A8_TAKE
VALUES ('009', '003','70.8',TO_DATE('2017-1-13','YYYY-MM-DD'));
INSERT INTO A8_TAKE
VALUES ('010', '001','98',TO_DATE('2017-1-13','YYYY-MM-DD'));
INSERT INTO A8_TAKE
VALUES ('011', '003','67.4',TO_DATE('2017-1-13','YYYY-MM-DD'));

--Question 1:
--List the last name and first name of the students who attend the lecture whose topic is peace
--and also involved in project whose ID is 002 at the same time. (Using explicit join in this query)

SELECT A8_PERSON.LastNM, A8_PERSON.FirstNM
FROM ((((A8_PERSON INNER JOIN A8_STUDENT
                ON A8_PERSON.P_ID = A8_STUDENT.P_ID)
                INNER JOIN A8_INSTRUCT
                ON A8_PERSON.P_ID = A8_INSTRUCT.Stu_ID)
                INNER JOIN A8_ATTEND
                ON A8_PERSON.P_ID = A8_ATTEND.P_ID)
                INNER JOIN A8_LECTURE
                ON A8_ATTEND.L_ID =A8_LECTURE.L_ID)
WHERE A8_INSTRUCT.P_ID = '002' AND A8_LECTURE.Topic ='Peace';


--Question 2:
--List all depatment name whose teacher ever present a lecture.
--Also list the topic of the lectures they present.(Using explicit join in this query)
SELECT A8_DEPARTMENT.D_Name, A8_LECTURE.Topic
FROM ((A8_DEPARTMENT INNER JOIN A8_PERSON
          ON A8_DEPARTMENT.D_ID = A8_PERSON.D_ID)
          INNER JOIN A8_LECTURE
          ON A8_PERSON.P_ID = A8_LECTURE.P_ID);

--Question 3:
--Find the number of girl who have ever taken the Data Science course.(Using explicit join in this query)
SELECT COUNT (A8_PERSON.Genre)
FROM ((A8_PERSON INNER JOIN A8_TAKE
      ON A8_PERSON.P_ID = A8_TAKE.P_ID)
      INNER JOIN  A8_COURSE
      ON A8_TAKE.C_ID = A8_COURSE.C_ID)
WHERE A8_COURSE.C_ID = '001' AND A8_PERSON.Genre = 'F';
